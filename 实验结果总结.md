# 实验结果总结

## 3.2 静态分析工具（Cppcheck）的检测结果

- **真实存在缺陷**：双重释放、空指针解引用、内存泄漏、未初始化变量
- **误报缺陷（没有对程序造成影响的规范警告）**：返回值引用、使用STL算法建议、缺少显式构造函数、已知条件真值判断、未使用的函数等
- Cppcheck检测到了4个真实缺陷，其中内存泄漏是通过`unusedAllocatedMemory`警告检测到的，虽然报告为"未使用的已分配内存"，但实际上这正是内存泄漏的表现，所以也可以算作是检测成功。
- 关于误报，主要是代码风格和规范建议。例如`returnByReference`警告建议返回引用而非值，`useStlAlgorithm`建议使用STL算法替代手写循环，`noExplicitConstructor`建议为单参数构造函数添加`explicit`关键字。这些虽然符合C++最佳实践，但在当前代码上下文中并不会造成实际运行错误。
- 至于`knownConditionTrueFalse`，这是Cppcheck检测到某些条件表达式在编译时就能确定其值，例如`if (index>=1)`在某些上下文中可能总是为真或假，这更多是代码逻辑的潜在问题提示。

## 3.3 大语言模型（ChatGPT）的检测结果

- **真实存在缺陷**：内存泄漏、双重释放、空指针解引用、释放后使用、缓冲区溢出、未初始化变量、整数溢出、除零错误、越界访问
- **误报缺陷（没有对程序造成影响的规范警告）**：未使用的变量、未使用的函数
- ChatGPT表现非常出色，成功检测到了所有9个植入的缺陷，检测率达到100%。它能够从语义层面理解代码逻辑，识别出各种类型的内存安全问题和算术错误。
- 不过，ChatGPT也存在一些误报。例如它报告了一些未使用的函数和变量，这些虽然确实存在，但并不会对程序运行造成影响，更多是代码清理的建议。另外，ChatGPT有时会给出一些过于保守的建议，比如在某些情况下会误判一些正常的代码模式为潜在问题。

## 3.4 形式化工具（ESBMC）的检测结果

- **真实存在缺陷**：内存泄漏、缓冲区溢出、除零错误、双重释放、整数溢出、空指针解引用、越界访问、释放后使用
- **漏报缺陷**：未初始化变量（ESBMC在最小化用例上未报告该错误）
- ESBMC作为形式化验证工具，通过符号执行和模型检测，成功检测到了8个真实缺陷，检测率达到88.9%。它能够通过数学证明的方式验证缺陷的存在，误报率极低。
- ESBMC在内存安全、算术错误和边界检查方面表现优异，能够给出精确的反例证明。例如对于双重释放，ESBMC通过状态机跟踪指针的分配和释放状态，能够准确识别出第二次释放操作。
- 唯一漏报的是未初始化变量（CWE-457）。这可能是因为在最小化测试用例中，ESBMC的前端分析未能捕获到该变量的使用路径，或者该变量的使用模式在形式化验证的约束求解中未能触发相应的警告。这也体现了形式化工具对代码简化程度和测试用例设计的依赖性。





